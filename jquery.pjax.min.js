/*
 * 
 * pjax
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.7.3
 * @updated 2013/04/12
 * @author falsandtru  http://fat.main.jp/  http://sa-kusaku.sakura.ne.jp/
 * @Compressor Closure Compiler
 */
(function(){function q(q){function r(g,c,b,B,a){function q(){a:if(a.speed.check?a.speed.log.name.push("update_start"):null,a.speed.check?a.speed.log.time.push(a.speed.now()-a.speed.log.fire):null,!1!==e(a.callbacks.update.before,g,[c,a.parameter,f,j,d])){try{if(-1===d.getResponseHeader("Content-Type").indexOf("text/html"))throw Error();var m=jQuery(f),u=0<m.filter("title").length,h=u?m.filter("title").text():z(f,"title","<title>([^<]*)</title>"),n,p,s=a.area.split(","),t=null===a.scrollLeft?jQuery(v).scrollLeft():
parseInt(a.scrollLeft),D=null===a.scrollTop?jQuery(v).scrollTop():parseInt(a.scrollTop);if(!jQuery(a.area).length||!m.find(a.area).add(m.filter(a.area)).length)throw Error();!1!==e(a.callbacks.update.url.before,g,[c,a.parameter,f,j,d])&&(b=b.replace(RegExp("[?&]"+a.server.query+"=.*?([sW#&]|$)"),""),B?history.pushState(null,v.opera||"userAgent"in v&&-1!==userAgent.indexOf("opera")?h:r.title,b):null,e(a.callbacks.update.url.after,g,[c,a.parameter,f,j,d]));!1!==e(a.callbacks.update.title.before,g,[c,
a.parameter,f,j,d])&&(r.title=h,e(a.callbacks.update.title.after,g,[c,a.parameter,f,j,d]));if(!1!==e(a.callbacks.update.content.before,g,[c,a.parameter,f,j,d])){for(var h=0,w;w=s[h];h++)jQuery(w).html(m.find(w).add(m.filter(w)).html()),a.load.script&&a.load.sync?jQuery(w).append(jQuery("<div/>",{"class":a.nss.class4html+"-loaded",style:"display: block !important; visibility: hidden !important; width: auto !important; height: 0 !important; margin: 0 !important; padding: 0 !important; border: none !important; position: absolute !important; top: -9999px !important; left: -9999px !important; font-size: 12px !important;"}).text("pjax")):
null;e(a.callbacks.update.content.after,g,[c,a.parameter,f,j,d])}a.load.css?setTimeout(function(){if(!1!==e(a.callbacks.update.css.before,g,[c,a.parameter,f,j,d])){n=u?m.find('link[rel="stylesheet"], style').add(m.filter('link[rel="stylesheet"], style')):z(f,"css",'(<link[^>]*?rel="stylesheet"[^>]*?>|<style[^>]*?>(.|[\n\r])*?</style>)');jQuery('link[rel="stylesheet"], style').filter(function(){return jQuery.data(this,a.nss.data,!0)});for(var b=0,h,l;h=n[b];b++){l=!1;h=u?h:jQuery(h)[0];if("LINK"===
h.tagName.toUpperCase()&&jQuery('link[rel="stylesheet"]').filter(function(){if(l||this.href!==h.href)return!1;l=!0;jQuery.data(this,a.nss.data)?jQuery.data(this,a.nss.data,!1):null;return!0}).length)continue;if("STYLE"===h.tagName.toUpperCase()&&jQuery("style").filter(function(){if(l||!jQuery.data(this,a.nss.data)||this.innerHTML!==h.innerHTML)return!1;l=!0;jQuery.data(this,a.nss.data,!1);return!0}).length)continue;jQuery.data(jQuery("head").append(h).children(":last-child").get(0),a.nss.data,!1);
h=null}jQuery('link[rel="stylesheet"], style').filter(function(){return jQuery.data(this,a.nss.data)}).remove();!1!==e(a.callbacks.update.css.after,g,[c,a.parameter,f,j,d])&&(a.speed.check?a.speed.log.name.push("css"):null,a.speed.check?a.speed.log.time.push(a.speed.now()-a.speed.log.fire):null)}},a.load.async||0):null;a.load.script?setTimeout(function(){y("async")},a.load.async||0):null;var y=function(b){if(!1!==e(a.callbacks.update.script.before,g,[c,a.parameter,f,j,d])){p=u?m.find("script").add(m.filter("script")):
z(f,"script","([^'\"]|^s*)(<script[^>]*?>(.|[\n\r])*?\x3c/script>)([^'\"]|s*$)");for(var h=0,l,k;l=p[h];h++)if(k=!1,l=u?l:jQuery(l)[0],!a.load.sync||"sync"!==b||l.defer)if((!a.load.sync||!("async"===b&&l.defer))&&!jQuery("script[src]").filter(function(){return k||this.src!==l.src?!1:k=!0}).length)jQuery.data(jQuery("head").append(l).children(":last-child").get(0),a.nss.data,!1),l=null;e(a.callbacks.update.script.after,g,[c,a.parameter,f,j,d])}};if(a.load.script&&a.load.sync){var x=setTimeout(function(){for(;x=
a.queue.shift();)clearTimeout(x);jQuery(a.area).length===jQuery(a.area).children("."+a.nss.class4html+"-loaded").filter(function(){return this.clientWidth}).length?(jQuery(a.area).children("."+a.nss.class4html+"-loaded").remove(),setTimeout(function(){y("sync")},0),a.speed.check?a.speed.log.name.push("script"):null,a.speed.check?a.speed.log.time.push(a.speed.now()-a.speed.log.fire):null,a.speed.check?console.log(a.speed.log.time):null,a.speed.check?console.log(a.speed.log.name):null,a.speed.check?
console.log(a.speed.log.retry):null):(x=setTimeout(arguments.callee,a.interval),a.queue.push(x),a.speed.check?++a.speed.log.retry:null);k[a.id]=a},0);a.queue.push(x);k[a.id]=a}B&&-1<"click,submit".indexOf(c.type.toLowerCase())?v.scrollTo(t,D):null;if(!1===e(a.callbacks.update.success,g,[c,a.parameter,f,j,d]))break a;if(!1===e(a.callbacks.update.complete,g,[c,a.parameter,f,j,d]))break a;if(!1===e(a.callback,g,[c,a.parameter,f,j,d]))break a}catch(C){if(!1===e(a.callbacks.update.error,g,[c,a.parameter,
f,j,d]))break a;if(!1===e(a.callbacks.update.complete,g,[c,a.parameter,f,j,d]))break a;a.fallback?A(c,g):null}!1!==e(a.callbacks.update.after,g,[c,a.parameter,f,j,d])&&(a.speed.check?a.speed.log.name.push("end"):null,a.speed.check?a.speed.log.time.push(a.speed.now()-a.speed.log.fire):null)}}var v=window,r=document,f,j,d,n,s,p=[],t={dataFilter:function(b,d){f=b;j=d;return e(a.callbacks.ajax.dataFilter,g,[c,a.parameter,f,j])},complete:function(b,f){d=b;n=f;e(a.callbacks.ajax.complete,g,[c,a.parameter,
d,n])}};a.speed.check?a.speed.log.fire=c.timeStamp:null;a.speed.check?a.speed.log.time=[]:null;a.speed.check?a.speed.log.name=[]:null;a.speed.check?a.speed.log.name.push("fire"):null;a.speed.check?a.speed.log.time.push(a.speed.now()-a.speed.log.fire):null;for(var y in t)y in a.callbacks.ajax||delete t[y];if("popstate"===c.type.toLowerCase()){if((p=b.match(/\?[^\s]*/))&&"?"!==p[0])a.ajax.type="GET";a.ajax.data=null}"submit"===c.type.toLowerCase()&&(b=b.replace(/\?[^\s]*/,""),a.ajax.type=jQuery(c.target).attr("method").toUpperCase(),
"GET"===a.ajax.type&&(b+="?"+jQuery(c.target).serialize(),a.ajax.data=null),"POST"===a.ajax.type&&(a.ajax.data=jQuery(c.target).serializeArray()));a.server.query&&(b=b.replace(/(#[^\s]*|)$/,(!b.match(/\?/)?"?":"&")+encodeURIComponent(a.server.query)+"=1$1"));if(!1===e(a.callbacks.before,g,[c,a.parameter]))return g;a.speed.check?a.speed.log.name.push("ajax_start"):null;a.speed.check?a.speed.log.time.push(a.speed.now()-a.speed.log.fire):null;void 0!==jQuery.when?jQuery.when(C(a.wait),jQuery.ajax(jQuery.extend(!0,
{},a.ajax,t,{url:b,beforeSend:function(b){d=b;d.setRequestHeader(a.nss.requestHeader,"true");d.setRequestHeader(a.nss.requestHeader+"-Area",a.area);d.setRequestHeader(a.nss.requestHeader+"-CSS",a.load.css);d.setRequestHeader(a.nss.requestHeader+"-Script",a.load.script);e(a.callbacks.ajax.beforeSend,g,[c,a.parameter,d])},success:function(b,k,h){f=b;j=k;d=h;e(a.callbacks.ajax.success,g,[c,a.parameter,f,j,d])},error:function(b,f,h){d=b;n=f;s=h;e(a.callbacks.ajax.error,g,[c,a.parameter,d,n,s]);a.fallback?
A(c,g):null}}))).done(function(){q()}).fail().always():jQuery.ajax(jQuery.extend(!0,{},a.ajax,t,{url:b,beforeSend:function(b){d=b;d.setRequestHeader(a.nss.requestHeader,"true");d.setRequestHeader(a.nss.requestHeader+"-Area",a.area);d.setRequestHeader(a.nss.requestHeader+"-CSS",a.load.css);d.setRequestHeader(a.nss.requestHeader+"-Script",a.load.script);e(a.callbacks.ajax.beforeSend,g,[c,a.parameter,d])},success:function(b,k,h){f=b;j=k;d=h;e(a.callbacks.ajax.success,g,[c,a.parameter,f,j,d]);q()},error:function(b,
f,h){d=b;n=f;s=h;e(a.callbacks.ajax.error,g,[c,a.parameter,d,n,s]);a.fallback?A(c,g):null}}));if(!1===e(a.callbacks.after,g,[c,a.parameter]))return g;c.preventDefault()}function e(b,c,e){if("function"===typeof b)return b.apply(c,e)}function C(b){var c=jQuery.Deferred();if(!b)return c.resolve();setTimeout(function(){c.resolve()},b);return c.promise()}function A(b,c){"click"===b.type.toLowerCase()?location.href=c.href:"submit"===b.type.toLowerCase()?c.submit():"popstate"===b.type.toLowerCase()&&location.reload()}
function z(b,c,e){var k=[];e=RegExp(e,"gim");switch(c){case "title":b.replace(e,function(a,b){k.push(b)});break;case "css":b.replace(e,function(a){k.push(a)});break;case "script":b.replace(e,function(a,b,c){k.push(c)})}return k}if("function"===typeof this)return arguments.callee.apply(jQuery(document),arguments);var p=window,b=jQuery.extend(!0,{},{id:0,gns:"pjax",ns:void 0,area:void 0,link:'a:not([target])[href^="/"]',form:void 0,scrollTop:0,scrollLeft:0,ajax:{},callback:function(){},callbacks:{ajax:{},
update:{url:{},title:{},content:{},css:{},script:{}}},parameter:void 0,load:{css:!1,script:!1,sync:!0,async:0},interval:300,queue:[],wait:0,fallback:!0,server:{query:"pjax"},delay:500,speed:{check:!1}},q);jQuery.extend(!0,b,{nss:{class4html:""+(b.gns+(b.ns?"-"+b.ns:null)),click:["click",b.gns+(b.ns?":"+b.ns:null)].join("."),submit:["submit",b.gns+(b.ns?":"+b.ns:null)].join("."),popstate:["popstate",b.gns+(b.ns?":"+b.ns:null)].join("."),data:b.gns+(b.ns?":"+b.ns:null),requestHeader:["X",b.gns.replace(/^(\w)/,
function(b){return b.toUpperCase()})].join("-")},timestamp:(new Date).getTime(),speed:{now:function(){return(new Date).getTime()},log:{retry:0}}});if(!(!("pushState"in p.history&&null!==p.history.pushState)?0:jQuery(b.area).length))return this;b.id=k.length;k.push(b);b.link&&(b.form||jQuery(this).undelegate(b.link,b.nss.click).delegate(b.link,b.nss.click,b.id,function(b){if(1<b.which||(b.metaKey||b.ctrlKey||b.shiftKey||b.altKey)||(location.protocol!==this.protocol||location.host!==this.host)||location.pathname===
this.pathname&&location.search===this.search&&location.hash!==this.hash)return this;r(this,b,this.href,location.href!==this.href,k[b.data])}));b.form&&jQuery(this).undelegate(b.form,b.nss.submit).delegate(b.form,b.nss.submit,b.id,function(b){r(this,b,jQuery(b.target).attr("action"),!0,k[b.data])});jQuery(p).unbind(b.nss.popstate).bind(b.nss.popstate,b.id,function(b){var c=k[b.data];!1!==c.timestamp&&c.delay>b.timeStamp-c.timestamp?(c.timestamp=!1,k[c.id]=c):r(this,b,location.href,!1,k[b.data])});
return this}if("undefined"!==typeof window.jQuery){window.undefined=void 0;jQuery=window.jQuery;var k=["settings"];window.jQuery.fn.pjax=q;window.jQuery.pjax=q;q=null}})();
