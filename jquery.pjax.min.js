/*
 * 
 * pjax
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.11.3
 * @updated 2013/05/10
 * @author falsandtru  http://fat.main.jp/  http://sa-kusaku.sakura.ne.jp/
 * @Compressor Closure Compiler
 */
(function(){function s(n){function s(h,b,f,v,c){function r(q){e&&e.test("++",1,0,"update()");e&&(e.scope=function(a){return eval(a)});a:if(a.speedcheck&&a.log.speed.name.push("update_start"),a.speedcheck&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire),!1!==k(a.callbacks.update.before,h,[b,a.parameter,l,j,d])){var c,m,p;try{if(!q&&!RegExp(a.contentType.replace(/\s*[,;]\s*(.|$)/g,function(a,h){return h?"|"+h:""}),"i").test(d.getResponseHeader("Content-Type")))throw Error();q&&!1!==k(a.callbacks.update.cache.load.before,
h,[b,a.parameter,q])&&(d=q.XMLHttpRequest,l=d.responseText,j=q.dataType,c=q.title,m=q.css,p=q.script,k(a.callbacks.update.cache.load.after,h,[b,a.parameter,q]));var n=jQuery(l),s=0<n.filter("title").length,x=a.area.replace(/(\((.*?(\(.*?\).*?)?)*?\)|\S)(,|$)/g,function(a,h,b,d,f){return h+(f?"|":"")}).split(/\s*\|(?!=)\s*/),u=null===a.scrollLeft?jQuery(g).scrollLeft():parseInt(a.scrollLeft),G=null===a.scrollTop?jQuery(g).scrollTop():parseInt(a.scrollTop);c=c?c:s?n.filter("title").text():jQuery("<span/>").html(B(l,
"<title>([^<]*)</title>").join()).text();if(!jQuery(a.area).length||!n.find(a.area).add(n.filter(a.area)).length)throw Error();if(!1!==k(a.callbacks.update.url.before,h,[b,a.parameter,l,j,d])){f=f.replace(RegExp("[?&]"+a.server.query+"=[^&#]*"),"");v&&g.history.pushState(a.gns,g.opera||-1!==g.navigator.userAgent.toLowerCase().indexOf("opera")?c:C.title,f);switch(!0){case /Mobile(\/\w+)? Safari/i.test(g.navigator.userAgent):g.history.back(),g.history.forward()}k(a.callbacks.update.url.after,h,[b,a.parameter,
l,j,d])}!1!==k(a.callbacks.update.title.before,h,[b,a.parameter,l,j,d])&&(C.title=c,k(a.callbacks.update.title.after,h,[b,a.parameter,l,j,d]));if(!1!==k(a.callbacks.update.content.before,h,[b,a.parameter,l,j,d])){for(var z=0,y;y=x[z];z++)jQuery(y).html(n.find(y).add(n.filter(y)).children()),a.load.script&&a.load.sync&&jQuery(y).append(jQuery("<div/>",{"class":a.nss.class4html+"-loaded",style:"display: block !important; visibility: hidden !important; width: auto !important; height: 0 !important; margin: 0 !important; padding: 0 !important; border: none !important; position: absolute !important; top: -9999px !important; left: -9999px !important; font-size: 12px !important; text-indent: 0 !important;"}).text("pjax"));
k(a.callbacks.update.content.after,h,[b,a.parameter,l,j,d])}a.load.css&&setTimeout(function(){if(!1!==k(a.callbacks.update.css.before,h,[b,a.parameter,l,j,d])){m=m?m:s?n.find('link[rel="stylesheet"], style').add(n.filter('link[rel="stylesheet"], style')):B(l,'(<link[^>]*?rel="stylesheet"[^>]*?>|<style[^>]*?>(.|[\n\r])*?</style>)');w(a.history,f).css=m;jQuery('link[rel="stylesheet"], style').filter(function(){return jQuery.data(this,a.nss.data,!0)});for(var g=0,c,q=jQuery('link[rel="stylesheet"]'),
e=jQuery("style"),v;c=m[g];g++){v=!1;c=s?c:jQuery(c)[0];if("LINK"===c.tagName.toUpperCase()&&q.filter(function(){if(v||this.href!==c.href)return!1;v=!0;jQuery.data(this,a.nss.data)&&jQuery.data(this,a.nss.data,!1);return!0}).length)continue;if("STYLE"===c.tagName.toUpperCase()&&e.filter(function(){if(v||!jQuery.data(this,a.nss.data)||this.innerHTML!==c.innerHTML)return!1;v=!0;jQuery.data(this,a.nss.data,!1);return!0}).length)continue;jQuery.data(jQuery("head").append(c).children(":last-child")[0],
a.nss.data,!1);c=null}jQuery('link[rel="stylesheet"], style').filter(function(){return jQuery.data(this,a.nss.data)}).remove();!1!==k(a.callbacks.update.css.after,h,[b,a.parameter,l,j,d])&&(a.speedcheck&&a.log.speed.name.push("css"),a.speedcheck&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire))}},a.load.async||0);a.load.script&&setTimeout(function(){D("async")},a.load.async||0);var D=function(c){if(!1!==k(a.callbacks.update.script.before,h,[b,a.parameter,l,j,d])){var g=[];p=p?p:s?n.find("script").add(n.filter("script")):
B(l,"(?:[^'\"]|^s*)(<script[^>]*?>(.|[\n\r])*?\x3c/script>)(?:[^'\"]|s*$)");w(a.history,f).script=p;for(var q=0,e;e=p[q];q++)if(e=s?e:jQuery(e)[0],"sync"!==c||e.defer)if(!("async"===c&&e.defer)&&(e.childNodes.length||!(e.src in a.log.script)))e.src&&(a.log.script[e.src]=!0),jQuery.when?(e=e.src?jQuery.ajax(jQuery.extend(!0,{},a.ajax,{url:e.src,dataType:"script",async:!1,global:!1})):jQuery.Deferred().resolve(e),g.push(e)):jQuery("head").append(e),e=null;jQuery.when&&g.length&&jQuery.when.apply(null,
g).done(function(){for(var a=0,h;h=arguments[a];a++)0<Number(h.nodeType)&&eval((h.text||h.textContent||h.innerHTML||"").replace(/^\s*<!(?:\[CDATA\[|\-\-)/,"/*$0*/"))});k(a.callbacks.update.script.after,h,[b,a.parameter,l,j,d])}};a.load.script&&a.load.sync?setTimeout(function(){jQuery(a.area).length===jQuery(a.area).children("."+a.nss.class4html+"-loaded").filter(function(){return this.clientWidth}).length?(jQuery(a.area).children("."+a.nss.class4html+"-loaded").remove(),setTimeout(function(){D("sync")},
0),a.speedcheck&&a.log.speed.name.push("script"),a.speedcheck&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire),a.speedcheck&&console.log(a.log.speed.time),a.speedcheck&&console.log(a.log.speed.name)):setTimeout(function(){arguments.callee()},a.interval)},0):a.load.script&&setTimeout(function(){D("sync")},a.load.async||0);switch(b.type.toLowerCase()){case "click":g.scrollTo(u,G);break;case "submit":g.scrollTo(u,G);break;case "popstate":g.history.state instanceof Object&&isFinite(g.history.state.scrollY)&&
(g.scrollTo(u,g.history.state.scrollY),g.history.state.scrollY=t,g.history.replaceState(g.history.state,c,f))}if((a.cache.click||a.cache.submit||a.cache.popstate)&&"POST"!==a.ajax.type&&!1!==k(a.callbacks.update.cache.save.before,h,[b,a.parameter,q]))w(a.history,f,c,A,l,j,d),k(a.callbacks.update.cache.save.after,h,[b,a.parameter,q]);if(!1===k(a.callbacks.update.success,h,[b,a.parameter,l,j,d]))break a;if(!1===k(a.callbacks.update.complete,h,[b,a.parameter,l,j,d]))break a;if(!1===k(a.callback,h,[b,
a.parameter,l,j,d]))break a;e&&e.test("++",1,0,"update: success")}catch(F){q&&w(a.history,f,c,null);if(!1===k(a.callbacks.update.error,h,[b,a.parameter,l,j,d]))break a;if(!1===k(a.callbacks.update.complete,h,[b,a.parameter,l,j,d]))break a;e&&e.test("++",1,[f,g.location.href],"update: error");if(a.fallback)return"function"===typeof a.fallback?a.fallback(b):E(b)}!1!==k(a.callbacks.update.after,h,[b,a.parameter,l,j,d])&&(a.on(),a.speedcheck&&a.log.speed.name.push("end"),a.speedcheck&&a.log.speed.time.push(a.speed.now()-
a.log.speed.fire),e&&e.test("++","url === win.location.href",[f,g.location.href],"update: is updated"),e&&e.end())}}var e=p[a.id]&&p[a.id].validate?p[a.id].validate.clone({name:"jquery.pjax.js :drive()"}):e;e&&e.start();e&&(e.scope=function(a){return eval(a)});e&&e.test(1,1,0,"drive()");a.speedcheck&&(a.log.speed.fire=b.timeStamp);a.speedcheck&&(a.log.speed.time=[]);a.speedcheck&&(a.log.speed.name=[]);a.speedcheck&&a.log.speed.name.push("fire");a.speedcheck&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire);
if(!1===k(a.callbacks.before,h,[b,a.parameter]))return h;if(c)jQuery.when?jQuery.when(z(a.wait)).done(function(){r(c)}):r(c);else{var l,j,d,m,n,A,F=[],x={xhr:function(){d=k(a.callbacks.ajax.xhr,h,[b,a.parameter]);d=d instanceof Object&&d instanceof g.XMLHttpRequest?d:d||jQuery.ajaxSettings.xhr();d instanceof Object&&(d instanceof g.XMLHttpRequest&&"onprogress"in d)&&d.addEventListener("progress",function(a){A=a.loaded},!1);return d},dataFilter:function(d,f){l=d;j=f;return k(a.callbacks.ajax.dataFilter,
h,[b,a.parameter,l,j])||l},complete:function(f,e){d=f;m=e;k(a.callbacks.ajax.complete,h,[b,a.parameter,d,m])}},u;for(u in x)u in a.callbacks.ajax||"xhr"===u||delete x[u];if("popstate"===b.type.toLowerCase()){if((F=f.match(/\?[^\s]*/))&&"?"!==F[0])a.ajax.type="GET";a.ajax.data=null}"submit"===b.type.toLowerCase()&&(f=f.replace(/\?[^\s]*/,""),a.ajax.type=jQuery(b.target).attr("method").toUpperCase(),"GET"===a.ajax.type&&(f+="?"+jQuery(b.target).serialize(),a.ajax.data=null),"POST"===a.ajax.type&&(a.ajax.data=
jQuery(b.target).serializeArray()));a.server.query&&(f=f.replace(/(#[^\s]*|)$/,(!f.match(/\?/)?"?":"&")+encodeURIComponent(a.server.query)+"=1$1"));a.speedcheck&&a.log.speed.name.push("ajax_start");a.speedcheck&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire);jQuery.when?jQuery.when(z(a.wait),jQuery.ajax(jQuery.extend(!0,{},a.ajax,x,{url:f,beforeSend:function(f){d=f;d.setRequestHeader(a.nss.requestHeader,"true");d.setRequestHeader(a.nss.requestHeader+"-Area",a.area);d.setRequestHeader(a.nss.requestHeader+
"-CSS",a.load.css);d.setRequestHeader(a.nss.requestHeader+"-Script",a.load.script);k(a.callbacks.ajax.beforeSend,h,[b,a.parameter,d])},success:function(f,e,c){l=f;j=e;d=c;k(a.callbacks.ajax.success,h,[b,a.parameter,l,j,d])},error:function(c,j,l){d=c;m=j;n=l;k(a.callbacks.ajax.error,h,[b,a.parameter,d,m,n]);e&&e.test("++",1,[f,g.location.href],"ajax error");e&&e.end();if(a.fallback)return"function"===typeof a.fallback?a.fallback(b):E(b)}}))).done(function(){r()}).fail().always():jQuery.ajax(jQuery.extend(!0,
{},a.ajax,x,{url:f,beforeSend:function(f){d=f;d.setRequestHeader(a.nss.requestHeader,"true");d.setRequestHeader(a.nss.requestHeader+"-Area",a.area);d.setRequestHeader(a.nss.requestHeader+"-CSS",a.load.css);d.setRequestHeader(a.nss.requestHeader+"-Script",a.load.script);k(a.callbacks.ajax.beforeSend,h,[b,a.parameter,d])},success:function(f,e,c){l=f;j=e;d=c;k(a.callbacks.ajax.success,h,[b,a.parameter,l,j,d]);r()},error:function(c,j,l){d=c;m=j;n=l;k(a.callbacks.ajax.error,h,[b,a.parameter,d,m,n]);e&&
e.test("++",1,[f,g.location.href],"ajax error");e&&e.end();if(a.fallback)return"function"===typeof a.fallback?a.fallback(b):E(b)}}));if(!1===k(a.callbacks.after,h,[b,a.parameter]))return h}}function k(a,b,f){if("function"===typeof a)return a.apply(b,f)}function z(a){var b=jQuery.Deferred();if(!a)return b.resolve();setTimeout(function(){b.resolve()},a);return b.promise()}function E(a){"click"===a.type.toLowerCase()?g.location.href=a.currentTarget.href:"submit"===a.type.toLowerCase()?context.submit():
"popstate"===a.type.toLowerCase()&&g.location.reload()}function B(a,b){var f=[];a.replace(RegExp(b,"gim"),function(a,h){f.push(h)});return f}function w(a,b,f,c,g,k,e){var l;switch(!0){case a===t||b===t:break;case f===t:a.data[b]&&(new Date).getTime()>a.data[b].timestamp+a.config.expire&&arguments.callee(a,b,null,null);l=a.data[b];break;case null===c:for(var j=0,d;d=a.order[j];j++)b===d&&(a.order.splice(j,1),a.size-=a.data[d].size,a.data[d]=null,delete a.data[d]);break;default:a.order.unshift(b);for(j=
1;d=a.order[j];j++)b===d&&a.order.splice(j,1);if(a.data[b])break;c=c||2*g.length;a.size=a.size||0;a.size+=c;a.data[b]={data:null,dataType:k,XMLHttpRequest:e,title:f,size:c,timestamp:(new Date).getTime()};for(j=a.order.length-1;b=a.order[j];j--)if(j>=a.config.length||a.size>a.config.size||(new Date).getTime()>a.data[b].timestamp+a.config.expire)a.order.splice(j,1),a.size=a.size||0,a.size-=a.data[b].size,a.data[b]=null,delete a.data[b]}return l}function A(a,b,f){var c;switch(!0){case b===t:c=jQuery.falsandtru[a];
break;case f===t:c=a in jQuery.falsandtru?jQuery.falsandtru[a][b]:t;break;case f!==t:jQuery.falsandtru[a]instanceof Object||(jQuery.falsandtru[a]={}),jQuery.falsandtru[a][b]instanceof Object&&f instanceof Object?jQuery.extend(!0,jQuery.falsandtru[a][b],f):jQuery.falsandtru[a][b]=f,c=jQuery.falsandtru[a][b]}return c}if("function"===typeof this)return arguments.callee.apply(jQuery(C),arguments);var r=window.validator instanceof Object?window.validator:!1;(r=r?r.clone({name:"jquery.pjax.js",base:!0,
timeout:{limit:n&&n.ajax&&n.ajax.timeout?n.ajax.timeout+r.timeout.limit:r.timeout.limit}}):r)&&r.start();r&&r.test(1,1,0,"plugin load");var a=jQuery.extend(!0,{},{id:0,gns:"pjax",ns:t,area:t,link:'a:not([target])[href^="/"]',form:t,scrollTop:0,scrollLeft:0,ajax:{},contentType:"text/html",cache:{click:!1,submit:!1,popstate:!1,length:9,size:1048576,expire:18E5},callback:function(){},callbacks:{ajax:{},update:{url:{},title:{},content:{},css:{},script:{},cache:{load:{},save:{}}}},parameter:t,load:{css:!1,
script:!1,sync:!0,async:0},interval:300,wait:0,fallback:!0,server:{query:""},speedcheck:!1},n),m=[a.gns].concat(a.ns||[]);jQuery.extend(!0,a,{nss:{pjax:m.join("."),click:["click"].concat(m.join(":")).join("."),submit:["submit"].concat(m.join(":")).join("."),popstate:["popstate"].concat(m.join(":")).join("."),data:m.join(":"),class4html:m.join("-"),requestHeader:["X",m[0].replace(/^\w/,function(a){return a.toUpperCase()})].join("-"),array:m},server:{query:a.server.query.length?a.server.query:a.gns},
log:{script:{},speed:{}},history:{config:a.cache,order:[],data:{}},timestamp:(new Date).getTime(),disable:!1,on:function(){for(var a=1,b=p.length;a<b;a++)p[a].disable=!1},off:function(){for(var a=1,b=p.length;a<b;a++)p[a].disable=!0},landing:g.location.href,validate:r,speed:{now:function(){return(new Date).getTime()}}});jQuery.falsandtru||(jQuery.fn.falsandtru=A,jQuery.falsandtru=A);jQuery.falsandtru("share","history",a.history);a.history=jQuery.falsandtru("share","history");if(!("pushState"in g.history&&
null!==g.history.pushState)?0:jQuery(a.area).length){var c=a;c.id=p.length;p.push(c);c.link&&jQuery(this).undelegate(c.link,c.nss.click).delegate(c.link,c.nss.click,c.id,function(a){a.timeStamp=(new Date).getTime();if(1<a.which||(a.metaKey||a.ctrlKey||a.shiftKey||a.altKey)||(g.location.protocol!==this.protocol||g.location.host!==this.host)||g.location.pathname===this.pathname&&g.location.search===this.search&&g.location.hash!==this.hash)return this;var b,c,k;b=p[a.data];c=this.href;b.cache[a.type.toLowerCase()]&&
(k=w(b.history,c));b.landing&&(b.landing=!1);if(b.disable)return a.preventDefault(),!1;b.off();s(this,a,c,c!==g.location.href,k);a.preventDefault();return!1});c.form&&jQuery(this).undelegate(c.form,c.nss.submit).delegate(c.form,c.nss.submit,c.id,function(a){a.timeStamp=(new Date).getTime();var b,c,g;b=p[a.data];c=jQuery(a.target).attr("action");b.cache[a.type.toLowerCase()]&&(g=w(b.history,c));b.landing&&(b.landing=!1);if(b.disable)return a.preventDefault(),!1;b.off();s(this,a,c,!0,g);a.preventDefault();
return!1});jQuery(g).unbind(c.nss.popstate).bind(c.nss.popstate,c.id,function(a){a.timeStamp=(new Date).getTime();var b,c,k;b=p[a.data];c=g.location.href;b.cache[a.type.toLowerCase()]&&(k=w(b.history,c));if(b.landing){if(b.landing===g.location.href){b.landing=!1;return}b.landing=!1}if(b.disable)return a.preventDefault(),!1;b.off();s(this,a,c,!1,k);a.preventDefault();return!1});jQuery("script[src]").each(function(){this.src in c.log.script||(c.log.script[this.src]=!0)})}r&&r.end();return{on:a.on,off:a.off}}
if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;var t=void 0,g=window,C=document,p=["settings"];jQuery.fn.pjax=s;jQuery.pjax=s;s=null}})();
