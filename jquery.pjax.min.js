/*
 * 
 * pjax
 * 
 * ---
 * @Copyright(c) 2012, falsandtru
 * @license MIT  http://opensource.org/licenses/mit-license.php  http://sourceforge.jp/projects/opensource/wiki/licenses%2FMIT_license
 * @version 1.11.6
 * @updated 2013/05/15
 * @author falsandtru  http://fat.main.jp/  http://sa-kusaku.sakura.ne.jp/
 * @Compressor Closure Compiler
 */
(function(){function t(p){function t(g,b,e,n,f){function s(l){j&&j.test("++",1,0,"update()");j&&(j.scope=function(a){return eval(a)});a:if(a.speedcheck&&a.log.speed.name.push("update_start"),a.speedcheck&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire),!1!==k(a.callbacks.update.before,g,[b,a.parameter,m,h,d])){var f,q,p;try{if(!l&&!RegExp(a.contentType.replace(/\s*[,;]\s*(.|$)/g,function(a,g){return g?"|"+g:""}),"i").test(d.getResponseHeader("Content-Type")))throw Error();l&&!1!==k(a.callbacks.update.cache.load.before,
g,[b,a.parameter,l])&&(d=l.XMLHttpRequest,m=d.responseText,h=l.dataType,f=l.title,q=l.css,p=l.script,k(a.callbacks.update.cache.load.after,g,[b,a.parameter,l]));var v=jQuery(m),t=0<v.filter("title").length,y=a.area.replace(/(\((.*?(\(.*?\).*?)?)*?\)|\S)(,|$)/g,function(a,g,b,d,e){return g+(e?"|":"")}).split(/\s*\|(?!=)\s*/),x=null===a.scrollLeft?jQuery(c).scrollLeft():parseInt(a.scrollLeft),H=null===a.scrollTop?jQuery(c).scrollTop():parseInt(a.scrollTop);f=f?f:t?v.filter("title").text():jQuery("<span/>").html(D(m,
"<title>([^<]*)</title>").join()).text();if(!jQuery(a.area).length||!v.find(a.area).add(v.filter(a.area)).length)throw Error();if(!1!==k(a.callbacks.update.url.before,g,[b,a.parameter,m,h,d])){e=e.replace(RegExp("[?&]"+a.server.query+"=[^&#]*"),"");n&&c.history.pushState(a.gns,c.opera||-1!==c.navigator.userAgent.toLowerCase().indexOf("opera")?f:E.title,e);switch(!0){case /Mobile(\/\w+)? Safari/i.test(c.navigator.userAgent):c.history.back(),c.history.forward()}k(a.callbacks.update.url.after,g,[b,a.parameter,
m,h,d])}!1!==k(a.callbacks.update.title.before,g,[b,a.parameter,m,h,d])&&(E.title=f,k(a.callbacks.update.title.after,g,[b,a.parameter,m,h,d]));if(!1!==k(a.callbacks.update.content.before,g,[b,a.parameter,m,h,d])){for(var A=0,z;z=y[A];A++)jQuery(z).html(v.find(z).add(v.filter(z)).children()),a.load.script&&a.load.sync&&jQuery(z).append(jQuery("<div/>",{"class":a.nss.class4html+"-loaded",style:"display: block !important; visibility: hidden !important; width: auto !important; height: 0 !important; margin: 0 !important; padding: 0 !important; border: none !important; position: absolute !important; top: -9999px !important; left: -9999px !important; font-size: 12px !important; text-indent: 0 !important;"}).text("pjax"));
k(a.callbacks.update.content.after,g,[b,a.parameter,m,h,d])}a.load.css&&setTimeout(function(){C()},a.load.async||0);var C=function(){var c=r[a.id]&&r[a.id].validate?r[a.id].validate.clone({name:"jquery.pjax.js :css()"}):c;c&&c.start();c&&(c.scope=function(a){return eval(a)});c&&c.test(1,1,0,"css()");if(!1!==k(a.callbacks.update.css.before,g,[b,a.parameter,m,h,d])){q=q?q:t?v.find('link[rel="stylesheet"], style').add(v.filter('link[rel="stylesheet"], style')):D(m,'(<link[^>]*?rel="stylesheet"[^>]*?>|<style[^>]*?>(.|[\n\r])*?</style>)');
w(a.history,e)&&(w(a.history,e).css=q);jQuery('link[rel="stylesheet"], style').filter(function(){return jQuery.data(this,a.nss.data,!0)});for(var f=0,l,j=jQuery('link[rel="stylesheet"]'),n=jQuery("style"),p;l=q[f];f++){p=!1;l=t?l:jQuery(l)[0];if("LINK"===l.tagName.toUpperCase()&&j.filter(function(){if(p||this.href!==l.href)return!1;p=!0;jQuery.data(this,a.nss.data)&&jQuery.data(this,a.nss.data,!1);return!0}).length)continue;if("STYLE"===l.tagName.toUpperCase()&&n.filter(function(){if(p||!jQuery.data(this,
a.nss.data)||this.innerHTML!==l.innerHTML)return!1;p=!0;jQuery.data(this,a.nss.data,!1);return!0}).length)continue;jQuery.data(jQuery("head").append(l).children(":last-child")[0],a.nss.data,!1);l=null}jQuery('link[rel="stylesheet"], style').filter(function(){return jQuery.data(this,a.nss.data)}).remove();!1!==k(a.callbacks.update.css.after,g,[b,a.parameter,m,h,d])&&(a.speedcheck&&a.log.speed.name.push("css"),a.speedcheck&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire))}c&&c.end()};a.load.script&&
setTimeout(function(){F("async")},a.load.async||0);var F=function(c){var l=r[a.id]&&r[a.id].validate?r[a.id].validate.clone({name:"jquery.pjax.js :script()"}):l;l&&l.start();l&&(l.scope=function(a){return eval(a)});l&&l.test(1,1,0,"script()");if(!1!==k(a.callbacks.update.script.before,g,[b,a.parameter,m,h,d])){var f=[];p=p?p:t?v.find("script").add(v.filter("script")):D(m,"(?:[^'\"]|^s*)(<script[^>]*?>(.|[\n\r])*?\x3c/script>)(?:[^'\"]|s*$)");w(a.history,e)&&(w(a.history,e).script=p);for(var j=0,n;n=
p[j];j++)if(n=t?n:jQuery(n)[0],"sync"!==c||n.defer)if(!("async"===c&&n.defer)&&(n.childNodes.length||!(n.src in a.log.script)))n.src&&(a.log.script[n.src]=!0),jQuery.when?(n=n.src?jQuery.ajax(jQuery.extend(!0,{},a.ajax,{url:n.src,dataType:"script",async:!1,global:!1})):jQuery.Deferred().resolve(n),f.push(n)):jQuery("head").append(n),n=null;jQuery.when&&f.length&&jQuery.when.apply(null,f).done(function(){for(var a=0,g;g=arguments[a];a++)0<Number(g.nodeType)&&eval((g.text||g.textContent||g.innerHTML||
"").replace(/^\s*<!(?:\[CDATA\[|\-\-)/,"/*$0*/"))});k(a.callbacks.update.script.after,g,[b,a.parameter,m,h,d])}l&&l.end()};a.load.script&&a.load.sync?setTimeout(function(){jQuery(a.area).length===jQuery(a.area).children("."+a.nss.class4html+"-loaded").filter(function(){return this.clientWidth}).length?(jQuery(a.area).children("."+a.nss.class4html+"-loaded").remove(),setTimeout(function(){F("sync")},0),a.speedcheck&&a.log.speed.name.push("script"),a.speedcheck&&a.log.speed.time.push(a.speed.now()-
a.log.speed.fire),a.speedcheck&&console.log(a.log.speed.time),a.speedcheck&&console.log(a.log.speed.name)):setTimeout(function(){arguments.callee()},a.interval)},0):a.load.script&&setTimeout(function(){F("sync")},a.load.async||0);switch(b.type.toLowerCase()){case "click":c.scrollTo(x,H);break;case "submit":c.scrollTo(x,H);break;case "popstate":c.history.state instanceof Object&&isFinite(c.history.state.scrollY)&&(c.scrollTo(x,c.history.state.scrollY),c.history.state.scrollY=u,c.history.replaceState(c.history.state,
f,e))}if((a.cache.click||a.cache.submit||a.cache.popstate)&&"POST"!==a.ajax.type&&!1!==k(a.callbacks.update.cache.save.before,g,[b,a.parameter,l]))w(a.history,e,f,B,m,h,d),k(a.callbacks.update.cache.save.after,g,[b,a.parameter,l]);if(!1===k(a.callbacks.update.success,g,[b,a.parameter,m,h,d]))break a;if(!1===k(a.callbacks.update.complete,g,[b,a.parameter,m,h,d]))break a;if(!1===k(a.callback,g,[b,a.parameter,m,h,d]))break a;j&&j.test("++",1,0,"update: success")}catch(I){l&&w(a.history,e,f,null);if(!1===
k(a.callbacks.update.error,g,[b,a.parameter,m,h,d]))break a;if(!1===k(a.callbacks.update.complete,g,[b,a.parameter,m,h,d]))break a;j&&j.test("++",1,[e,c.location.href],"update: error");if(a.fallback)return"function"===typeof a.fallback?a.fallback(b):G(b)}!1!==k(a.callbacks.update.after,g,[b,a.parameter,m,h,d])&&(a.on(),a.speedcheck&&a.log.speed.name.push("end"),a.speedcheck&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire),j&&j.test("++","url === win.location.href",[e,c.location.href],"update: is updated"),
j&&j.end())}}var j=r[a.id]&&r[a.id].validate?r[a.id].validate.clone({name:"jquery.pjax.js :drive()"}):j;j&&j.start();j&&(j.scope=function(a){return eval(a)});j&&j.test(1,1,0,"drive()");a.speedcheck&&(a.log.speed.fire=b.timeStamp);a.speedcheck&&(a.log.speed.time=[]);a.speedcheck&&(a.log.speed.name=[]);a.speedcheck&&a.log.speed.name.push("fire");a.speedcheck&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire);if(!1===k(a.callbacks.before,g,[b,a.parameter]))return g;if(f)jQuery.when?jQuery.when(A(a.wait)).done(function(){s(f)}):
s(f);else{var m,h,d,q,p,B,C=[],y={xhr:function(){d=k(a.callbacks.ajax.xhr,g,[b,a.parameter]);d=d instanceof Object&&d instanceof c.XMLHttpRequest?d:d||jQuery.ajaxSettings.xhr();d instanceof Object&&(d instanceof c.XMLHttpRequest&&"onprogress"in d)&&d.addEventListener("progress",function(a){B=a.loaded},!1);return d},dataFilter:function(d,e){m=d;h=e;return k(a.callbacks.ajax.dataFilter,g,[b,a.parameter,m,h])||m},complete:function(e,c){d=e;q=c;k(a.callbacks.ajax.complete,g,[b,a.parameter,d,q])}},x;for(x in y)x in
a.callbacks.ajax||"xhr"===x||delete y[x];if("popstate"===b.type.toLowerCase()){if((C=e.match(/\?[^\s]*/))&&"?"!==C[0])a.ajax.type="GET";a.ajax.data=null}"submit"===b.type.toLowerCase()&&(e=e.replace(/\?[^\s]*/,""),a.ajax.type=jQuery(b.target).attr("method").toUpperCase(),"GET"===a.ajax.type&&(e+="?"+jQuery(b.target).serialize(),a.ajax.data=null),"POST"===a.ajax.type&&(a.ajax.data=jQuery(b.target).serializeArray()));a.server.query&&(e=e.replace(/(#[^\s]*|)$/,(!e.match(/\?/)?"?":"&")+encodeURIComponent(a.server.query)+
"=1$1"));a.speedcheck&&a.log.speed.name.push("ajax_start");a.speedcheck&&a.log.speed.time.push(a.speed.now()-a.log.speed.fire);jQuery.when?jQuery.when(A(a.wait),jQuery.ajax(jQuery.extend(!0,{},a.ajax,y,{url:e,beforeSend:function(e){d=e;d.setRequestHeader(a.nss.requestHeader,"true");d.setRequestHeader(a.nss.requestHeader+"-Area",a.area);d.setRequestHeader(a.nss.requestHeader+"-CSS",a.load.css);d.setRequestHeader(a.nss.requestHeader+"-Script",a.load.script);k(a.callbacks.ajax.beforeSend,g,[b,a.parameter,
d])},success:function(e,c,n){m=e;h=c;d=n;k(a.callbacks.ajax.success,g,[b,a.parameter,m,h,d])},error:function(n,f,h){d=n;q=f;p=h;k(a.callbacks.ajax.error,g,[b,a.parameter,d,q,p]);j&&j.test("++",1,[e,c.location.href],"ajax error");j&&j.end();if(a.fallback)return"function"===typeof a.fallback?a.fallback(b):G(b)}}))).done(function(){s()}).fail().always():jQuery.ajax(jQuery.extend(!0,{},a.ajax,y,{url:e,beforeSend:function(e){d=e;d.setRequestHeader(a.nss.requestHeader,"true");d.setRequestHeader(a.nss.requestHeader+
"-Area",a.area);d.setRequestHeader(a.nss.requestHeader+"-CSS",a.load.css);d.setRequestHeader(a.nss.requestHeader+"-Script",a.load.script);k(a.callbacks.ajax.beforeSend,g,[b,a.parameter,d])},success:function(e,c,n){m=e;h=c;d=n;k(a.callbacks.ajax.success,g,[b,a.parameter,m,h,d]);s()},error:function(n,f,h){d=n;q=f;p=h;k(a.callbacks.ajax.error,g,[b,a.parameter,d,q,p]);j&&j.test("++",1,[e,c.location.href],"ajax error");j&&j.end();if(a.fallback)return"function"===typeof a.fallback?a.fallback(b):G(b)}}));
if(!1===k(a.callbacks.after,g,[b,a.parameter]))return g}}function k(a,b,e){if("function"===typeof a)return a.apply(b,e)}function A(a){var b=jQuery.Deferred();if(!a)return b.resolve();setTimeout(function(){b.resolve()},a);return b.promise()}function G(a){"click"===a.type.toLowerCase()?c.location.href=a.currentTarget.href:"submit"===a.type.toLowerCase()?context.submit():"popstate"===a.type.toLowerCase()&&c.location.reload()}function D(a,b){var e=[];a.replace(RegExp(b,"gim"),function(a,g){e.push(g)});
return e}function w(a,b,e,c,f,k,j){var m;switch(!0){case a===u||b===u:break;case e===u:a.data[b]&&(new Date).getTime()>a.data[b].timestamp+a.config.expire&&arguments.callee(a,b,null,null);m=a.data[b];break;case null===c:for(var h=0,d;d=a.order[h];h++)b===d&&(a.order.splice(h,1),a.size-=a.data[d].size,a.data[d]=null,delete a.data[d]);break;default:a.order.unshift(b);for(h=1;d=a.order[h];h++)b===d&&a.order.splice(h,1);if(a.data[b])break;c=c||2*f.length;a.size=a.size||0;a.size+=c;a.data[b]={data:null,
dataType:k,XMLHttpRequest:j,title:e,size:c,timestamp:(new Date).getTime()};for(h=a.order.length-1;b=a.order[h];h--)if(h>=a.config.length||a.size>a.config.size||(new Date).getTime()>a.data[b].timestamp+a.config.expire)a.order.splice(h,1),a.size=a.size||0,a.size-=a.data[b].size,a.data[b]=null,delete a.data[b]}return m}function B(a,b,e){var c;switch(!0){case b===u:c=jQuery.falsandtru[a];break;case e===u:c=a in jQuery.falsandtru?jQuery.falsandtru[a][b]:u;break;case e!==u:jQuery.falsandtru[a]instanceof
Object||(jQuery.falsandtru[a]={}),jQuery.falsandtru[a][b]instanceof Object&&e instanceof Object?jQuery.extend(!0,jQuery.falsandtru[a][b],e):jQuery.falsandtru[a][b]=e,c=jQuery.falsandtru[a][b]}return c}if("function"===typeof this)return arguments.callee.apply(jQuery(E),arguments);var s=window.validator instanceof Object?window.validator:!1;(s=s?s.clone({name:"jquery.pjax.js",base:!0,timeout:{limit:p&&p.ajax&&p.ajax.timeout?p.ajax.timeout+s.timeout.limit:s.timeout.limit}}):s)&&s.start();s&&s.test(1,
1,0,"plugin load");var a=jQuery.extend(!0,{},{id:0,gns:"pjax",ns:u,area:u,link:'a:not([target])[href^="/"]',form:u,scrollTop:0,scrollLeft:0,ajax:{},contentType:"text/html",cache:{click:!1,submit:!1,popstate:!1,length:9,size:1048576,expire:18E5},callback:function(){},callbacks:{ajax:{},update:{url:{},title:{},content:{},css:{},script:{},cache:{load:{},save:{}}}},parameter:u,load:{css:!1,script:!1,sync:!0,async:0},interval:300,wait:0,fallback:!0,server:{query:""},speedcheck:!1},p),q=[a.gns].concat(a.ns||
[]);jQuery.extend(!0,a,{nss:{pjax:q.join("."),click:["click"].concat(q.join(":")).join("."),submit:["submit"].concat(q.join(":")).join("."),popstate:["popstate"].concat(q.join(":")).join("."),data:q.join(":"),class4html:q.join("-"),requestHeader:["X",q[0].replace(/^\w/,function(a){return a.toUpperCase()})].join("-"),array:q},server:{query:a.server.query.length?a.server.query:a.gns},log:{script:{},speed:{}},history:{config:a.cache,order:[],data:{}},timestamp:(new Date).getTime(),disable:!1,on:function(){for(var a=
1,b=r.length;a<b;a++)r[a].disable=!1},off:function(){for(var a=1,b=r.length;a<b;a++)r[a].disable=!0},landing:c.location.href,validate:s,speed:{now:function(){return(new Date).getTime()}}});jQuery.falsandtru||(jQuery.fn.falsandtru=B,jQuery.falsandtru=B);jQuery.falsandtru("share","history",a.history);a.history=jQuery.falsandtru("share","history");if(!("pushState"in c.history&&null!==c.history.pushState)?0:jQuery(a.area).length){var f=a;f.id=r.length;r.push(f);f.link&&jQuery(this).undelegate(f.link,
f.nss.click).delegate(f.link,f.nss.click,f.id,function(a){a.timeStamp=(new Date).getTime();if(1<a.which||(a.metaKey||a.ctrlKey||a.shiftKey||a.altKey)||(c.location.protocol!==this.protocol||c.location.host!==this.host)||c.location.pathname===this.pathname&&c.location.search===this.search&&c.location.hash!==this.hash)return this;var b,e,f;b=r[a.data];e=this.href;b.cache[a.type.toLowerCase()]&&(f=w(b.history,e));b.landing&&(b.landing=!1);if(b.disable)return a.preventDefault(),!1;b.off();t(this,a,e,e!==
c.location.href,f);a.preventDefault();return!1});f.form&&jQuery(this).undelegate(f.form,f.nss.submit).delegate(f.form,f.nss.submit,f.id,function(a){a.timeStamp=(new Date).getTime();var b,c,f;b=r[a.data];c=this.action;b.cache[a.type.toLowerCase()]&&(f=w(b.history,c));b.landing&&(b.landing=!1);if(b.disable)return a.preventDefault(),!1;b.off();t(this,a,c,!0,f);a.preventDefault();return!1});jQuery(c).unbind(f.nss.popstate).bind(f.nss.popstate,f.id,function(a){a.timeStamp=(new Date).getTime();var b,e,
f;b=r[a.data];e=c.location.href;b.cache[a.type.toLowerCase()]&&(f=w(b.history,e));if(b.landing){if(b.landing===c.location.href){b.landing=!1;return}b.landing=!1}if(b.disable)return a.preventDefault(),!1;b.off();t(this,a,e,!1,f);a.preventDefault();return!1});jQuery("script[src]").each(function(){this.src in f.log.script||(f.log.script[this.src]=!0)})}s&&s.end();return{on:a.on,off:a.off}}if("undefined"!==typeof window.jQuery){jQuery=window.jQuery;var u=void 0,c=window,E=document,r=["settings"];jQuery.fn.pjax=
t;jQuery.pjax=t;t=null}})();
